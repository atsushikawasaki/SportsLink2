# 実装タスク

- [ ] **プロジェクト初期化 & インフラ** <!-- id: 0 -->
    - [ ] Next.js (App Router) + TypeScript プロジェクト作成 <!-- id: 1 -->
    - [ ] Tailwind CSS + Shadcn/UI セットアップ <!-- id: 2 -->
    - [ ] ディレクトリ構成の整備 (Feature-based: `src/features/*`) <!-- id: 3 -->
    - [ ] Supabase クライアント設定 (SSR/Client/Middleware) <!-- id: 4 -->
    - [ ] Docker設定 (Next.js standaloneビルド) <!-- id: 31 -->
    - [ ] **セキュリティ設定** (Security Headers, Rate Limiting) <!-- id: 39 -->
- [ ] **データベース & セキュリティ (Supabase)** <!-- id: 5 -->
    - [ ] マイグレーション: Users, Tournaments (Enum定義含む) <!-- id: 7 -->
    - [ ] マイグレーション: Teams, Players, Pairs (制約設定: 団体/個人) <!-- id: 32 -->
    - [ ] マイグレーション: Matches, Points, Match_Slots (インデックス設定) <!-- id: 33 -->
    - [ ] **監査ログシステム** (Triggerによる `Audit_Logs` 自動記録) <!-- id: 9 -->
    - [ ] RLSポリシー実装 (要件定義書3.3完全準拠 + 複雑な権限委譲) <!-- id: 8 -->
- [ ] **ドメイン機能: 認証 & ユーザー (Auth)** <!-- id: 11 -->
    - [ ] ログイン・サインアップ・パスワードリセットUI (Zodバリデーション) <!-- id: 12 -->
    - [ ] **通知センター** (認証キー保存, 審判依頼通知) <!-- id: 40 -->
    - [ ] 権限管理 (Role Guard / Middleware) <!-- id: 34 -->
- [ ] **ドメイン機能: 大会管理 (Tournaments)** <!-- id: 14 -->
    - [ ] 大会CRUD & ステータス管理 (下書き/公開/終了) <!-- id: 15 -->
    - [ ] エントリー管理 (CSVインポート/エクスポート, **当日チェックイン/認証キー発行**) <!-- id: 16 -->
    - [ ] **ドロー生成エンジン** (シード/所属考慮アルゴリズム - `DrawEngineService`) <!-- id: 17 -->
    - [ ] 試合割当・審判アサイン管理 (一括割当UI) <!-- id: 19 -->
- [ ] **ドメイン機能: 試合 & スコアリング (Matches)** <!-- id: 18 -->
    - [ ] **スコア計算エンジン** (通常/ファイナル/デュース論理, 純粋関数) <!-- id: 20 -->
    - [ ] **審判用スコアボードUI** (**Mobile First/大ボタン**, 視認性重視) <!-- id: 21 -->
    - [ ] **信頼性機能: オフライン/同期** (IndexedDB + Queue + **楽観的ロック競合解決**) <!-- id: 35 -->
    - [ ] **信頼性機能: トラブルシューティング** (審判強制解除, **試合差し戻し/Revert**, スコア直接修正) <!-- id: 41 -->
    - [ ] 認証キーによる権限委譲ロジック (敗者審判オートサイン) <!-- id: 36 -->
- [ ] **公開・観戦 (Public)** <!-- id: 22 -->
    - [ ] リアルタイムライブスコア (Supabase Realtime, 5秒更新) <!-- id: 23 -->
    - [ ] 公開大会一覧・検索フィルター <!-- id: 24 -->
- [ ] **品質検証 & テスト** <!-- id: 25 -->
    - [ ] 単体テスト (Vitest: ドロー生成/スコア計算/ルール適合性) <!-- id: 26 -->
    - [ ] E2Eテスト (Playwright: 重要フロー網羅) <!-- id: 37 -->
    - [ ] **ブラウザ操作シナリオテスト** (Antigravityによる実操作検証: 管理/審判/観戦) <!-- id: 27 -->
- [ ] **デプロイ準備** <!-- id: 28 -->
    - [ ] CI/CD設定 (GitHub Actions: Lint/Test/Build/Security Scan) <!-- id: 38 -->
    - [ ] 環境変数・セキュリティ設定確認 <!-- id: 30 -->
